# Predicting Human Eye Fixations via an LSTM-based Saliency Attentive Model
This repository contains the source code of CVPR 2017 submission #899

## Abstract

Data-driven saliency has recently gained a lot of attention thanks to the use of Convolutional Neural Networks. In this paper we go beyond the standard approach to saliency prediction, in which gaze maps are computed with a feed-forward network, and we present a novel Saliency Attentive Model which can predict accurate saliency maps by incorporating attentive mechanisms. Our solution is composed of a Convolutional LSTM, that iteratively focuses on the most salient regions of the input, and a Residual Architecture designed to preserve spatial resolution. Additionally, to tackle the center bias present in human eye fixations, our model incorporates prior maps generated by learned Gaussian functions. We show, through an extensive evaluation, that the proposed architecture overcomes the current state of the art on three public saliency prediction datasets: SALICON, MIT300 and CAT2000. We further study the contribution of each key components to demonstrate their robustness on different scenarios.

![sam-fig]

[sam-fig]: https://raw.githubusercontent.com/cvpr17-id899/saliency/master/figs/model.pdf "SAM"

## Requirements
* [Theano](https://github.com/Theano/Theano) 0.9.0
* [Keras](https://github.com/fchollet/keras) 1.1.0, configured for using Theano as backend 
* OpenCV 3.0.0

Note: Be sure to have ```"image_dim_ordering": "th"``` and ```"backend": "theano"``` in your keras.json file.

## Usage

To compute saliency maps using our pre-trained model:
```
python main.py test path/to/images/folder/
```
where "path/to/images/folder/" is the path of a folder containing the images for which you want to calculate the saliency maps.

To train our model from scratch:
```
python main.py train
```
It is also necessary to set parameters and paths in the [config.py](config.py) file.

## Pretrained Models
Download one of the following pretrained models:

* SAM trained on SALICON: **[sam_salicon_weights.pkl]()**
* SAM trained on MIT1003: **[sam_mit1003_weights.pkl]()**
* SAM trained on CAT2000: **[sam_cat2000_weights.pkl]()**

## Precomputed Saliency Maps

We provide saliency maps predicted by our model for three standard datasets:

* **[SALICON validation set]()**
* **[MIT1003 dataset]()** 
* **[CAT2000 training set]()** 
